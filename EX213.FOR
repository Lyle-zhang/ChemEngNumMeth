C
C*****************************	ABSTRACT  *******************************
C
C     THIS PROGRAM APPLIES THE SECANT METHOD FOR THE SOLUTION OF A
C  SINGLE NONLINEAR EQUATION.
C
C****************************  NOMENCLATURE  ****************************
C
C  DXMAX- THE MAXIMUM ALLOWED CHANGE IN X BETWEEN ITERATIONS
C	  (USER SPECIFIED)
C  ERLIM- CONVERGENCE CRITERIA
C  ICMAX- THE MAXIMUM NUMBER OF ITERATIONS ALLOWED
C  IPRINT- PRINT FLAG =1 PRINT INTERMEDIATE VALUES; =0 NO PRINT
C  X-  THE INITIAL GUESS FOR THE ROOT (INPUT); THE SOLUTION VALUE OF
C      X (OUTPUT)
C
C************************************************************************
C
C  SPECIFY EXTERNAL STATEMENT
      IMPLICIT REAL*8(A-H,O-Z)
      EXTERNAL F
C  SPECIFY PARAMETERS
      ERLIM=1.E-8
      ICMAX=100
      IPRINT=1
      DXMAX=1.
C  SPECIFY STARTING POINT
      X=-.5
C
C  CALL SECANT
C
      CALL SECANT(F,ERLIM,ICMAX,DXMAX,IPRINT,X)
C
C  END
C
      STOP
      END
C
C*****************************  ABSTRACT  *******************************
C
C     THIS SUBROUTINE APPLIES THE SECANT METHOD FOR THE SOLUTION OF A
C  SINGLE NONLINEAR EQUATION.
C
C****************************  NOMENCLATURE  ****************************
C
C  DX- THE CALCULATED CHANGE IN THE VALUE OF X
C  DXMAX- THE MAXIMUM ALLOWED CHANGE IN X BETWEEN ITERATIONS
C	  (USER SPECIFIED)
C  ERLIM- CONVERGENCE CRITERIA
C  FO- THE NEXT TO THE LATEST FUNCTION VALUE
C  F1- THE LATEST FUNCTION VALUE
C  FV- THE FUNCTION VALUE
C  IC- THE ITERATION COUNTER
C  ICMAX- THE MAXIMUM NUMBER OF ITERATIONS ALLOWED
C  IPRINT- PRINT FLAG =1 PRINT INTERMEDIATE VALUES; =0 NO PRINT
C  X1-	THE LATEST VALUE THE ROOT OF THE NONLINEAR EQUATION
C  XO-	THE NEXT TO THE LATEST VALUE THE ROOT OF THE NONLINEAR EQUATION
C
C************************************************************************
C
      SUBROUTINE SECANT(F,ERLIM,ICMAX,DXMAX,IPRINT,X1)
      IMPLICIT REAL*8(A-H,O-Z)
      EXTERNAL F
      IC=0
C
C  BEGIN ITERATIVE LOOP
C
   10 IC=IC+1
C  CALL SUBRUTINE F
      CALL F(X1,F1)
C  INITIALIZE SECANT METHOD
      IF(IC.EQ.1)XO=X1*.95
      IF(IC.EQ.1)CALL F(XO,FO)
C  APPLY SECANT APPROXIATION
      DX=-F1*(X1-XO)/(F1-FO)
      IF(DABS(DX).GT.DXMAX)DX=DXMAX*DABS(DX)/DX
      XC=X1+DX
C  TRANSFER X1,F1 TO XO,FO
      XO=X1
      FO=F1
      X1=XC
C  PRINT OUT INTERMEDIATE RESULTS
      IF(IPRINT.EQ.1)WRITE(6,11)IC,XC,F1
   11 FORMAT( 5X,' IC=',I3,5X,' X=',D14.6,5X,' F(X)=',D10.3)
C  CHECK FOR EXCESSIVE ITERATIONS
      IF(IC.GT.ICMAX)WRITE(6,22)
   22 FORMAT( ' SECANT METHOD DID NOT CONVERGE')
      IF(IC.GT.ICMAX)STOP
C  CHECK FOR CONVERGENCE
      IF(DABS(DX).GT.ERLIM)GO TO 10
      CALL F(X1,F1)
C
C  CONVERGED SOLUTION OBTAINED; RETURNING TO CALLING PROGRAM
C
      RETURN
      END
C
C*****************************  ABSTRACT  *******************************
C
C     THIS SUBROUTINE CALCULATES THE CALCULATES THE VALUE OF F(X)
C  GIVEN THE VALUE OF X.
C
C************************************************************************
C
      SUBROUTINE F(X,FV)
      IMPLICIT REAL*8(A-H,O-Z)
      FV=2.*(2925.*X*X*X+757.5*X*X+37.*X)+1.5
      RETURN
      END
